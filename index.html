<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <title>Challenge Web App</title>
  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <style>
    :root {
      --bg: #0b0c10;
      --panel: #121318;
      --muted: #9aa0a6;
      --text: #e8eaed;
      --primary: #5b8cff;
      --border: #23252e;
    }
    * { box-sizing: border-box }
    body { margin: 0; font-family: Inter, system-ui, Segoe UI, Roboto, Arial, sans-serif; background: var(--bg); color: var(--text) }
    header { display: flex; justify-content: space-between; align-items: center; background: var(--panel); padding: 10px 16px; border-bottom: 1px solid var(--border) }
    .search { padding: 8px 10px; border-radius: 8px; border: 1px solid var(--border); background: #0f1116; color: var(--text); width: 320px; max-width: 50vw }
    .btn { padding: 8px 12px; border-radius: 8px; border: 1px solid var(--border); background: #1a1c23; color: var(--text); cursor: pointer; transition: background .2s }
    .btn.primary { background: var(--primary); border: none; color: #fff }
    select, .input, textarea { padding: 8px; border-radius: 8px; background: #0f1116; color: var(--text); border: 1px solid var(--border) }
    .layout { display: grid; grid-template-columns: 1fr 320px; gap: 16px; padding: 16px }
    .panel { background: var(--panel); border: 1px solid var(--border); border-radius: 12px; padding: 12px }
    .feed { display: grid; gap: 12px }
    .card { background: var(--panel); border: 1px solid var(--border); border-radius: 12px; padding: 12px }
    .meta { font-size: 14px; color: var(--muted); display: flex; gap: 12px; flex-wrap: wrap }
    .desc { margin: 8px 0; color: #cfd3d7 }
    .leaderboard .row { display: flex; justify-content: space-between; padding: 8px; border: 1px solid var(--border); border-radius: 8px; margin-top: 6px; background: #0f1116 }
    .backdrop { position: fixed; inset: 0; background: rgba(0,0,0,.5); display: none; align-items: center; justify-content: center; z-index: 40 }
    .modal { width: min(640px,92vw); background: var(--panel); border: 1px solid var(--border); border-radius: 12px; padding: 16px }
    .modal header { display: flex; justify-content: space-between; align-items: center; margin-bottom: 8px }
    .grid-2 { display: grid; grid-template-columns: 1fr 1fr; gap: 10px }
    .divider { height: 1px; background: var(--border); margin: 10px 0 }
    .toast { position: fixed; right: 16px; bottom: 16px; display: flex; flex-direction: column; gap: 8px; z-index: 50 }
    .toast .item { background: #11141c; border: 1px solid var(--border); color: #cbd5e1; padding: 10px 12px; border-radius: 10px; box-shadow: 0 4px 20px rgba(0,0,0,.3); transition: opacity .5s, transform .5s }
    @media (max-width:1024px) { .layout { grid-template-columns: 1fr } }
  </style>
</head>
<body>

<header>
  <input type="text" id="searchInput" class="search" placeholder="Search" aria-label="Search Challenges">
  <div style="display:flex;gap:8px;align-items:center">
    <select id="languageSelect" aria-label="Select Language">
      <option value="en">English</option>
      <option value="bn">‡¶¨‡¶æ‡¶Ç‡¶≤‡¶æ</option>
      <option value="hi">‡§π‡§ø‡§Ç‡§¶‡•Ä</option>
    </select>
    <button class="btn primary" id="postBtn">Post Challenge</button>
  </div>
</header>

<div class="layout">
  <main>
    <div class="feed" id="challengeFeed"></div>
  </main>

  <aside class="panel">
    <h3 id="interestTitle">Select Interests</h3>
    <select id="interestSelect" class="input" aria-label="Select Interests">
      <option value="All">üåç All</option>
      <optgroup label="üìö Education">
        <option value="Language Learning">Language Learning</option>
        <option value="Science & Technology">Science & Technology</option>
        <option value="Math & Logic Puzzles">Math & Logic Puzzles</option>
        <option value="History & Culture">History & Culture</option>
        <option value="Coding & Programming">Coding & Programming</option>
        <option value="Skill Development">Skill Development</option>
      </optgroup>
      <optgroup label="üé≠ Entertainment">
        <option value="Fun Challenges">Fun Challenges</option>
        <option value="Creative Arts">Creative Arts</option>
        <option value="Music & Singing">Music & Singing</option>
        <option value="Dance & Performance">Dance & Performance</option>
        <option value="Storytelling / Acting">Storytelling / Acting</option>
        <option value="Food & Cooking Challenges">Food & Cooking Challenges</option>
      </optgroup>
      <optgroup label="‚ö° Mixed / Lifestyle">
        <option value="Fitness & Sports">Fitness & Sports</option>
        <option value="Travel & Exploration">Travel & Exploration</option>
        <option value="Photography & Videography">Photography & Videography</option>
        <option value="DIY Projects">DIY Projects</option>
        <option value="Social Awareness Challenges">Social Awareness Challenges</option>
      </optgroup>
    </select>
    <div style="margin-top:12px">
      <h3 id="leaderboardTitle">Leaderboard</h3>
      <div id="leaderboard" class="leaderboard"></div>
    </div>
  </aside>
</div>

<!-- Post Modal -->
<div id="backdrop" class="backdrop" aria-modal="true" role="dialog">
  <div class="modal">
    <header>
      <h3 id="modalTitle">Post a Challenge</h3>
      <button class="btn" id="closeModal" aria-label="Close Modal">‚úï</button>
    </header>
    <form id="challengeForm" autocomplete="off">
      <div class="grid-2">
        <div>
          <label for="mTitle" id="lblTitle">Title (current language)</label>
          <input id="mTitle" class="input" placeholder="e.g., 30-sec Science Fact" required />
        </div>
        <div>
          <label for="mCategory" id="lblCategory">Category</label>
          <select id="mCategory" class="input" required>
            <option>Science & Technology</option>
            <option>Fun Challenges</option>
            <option>Coding & Programming</option>
            <option>Language Learning</option>
            <option>Math & Logic Puzzles</option>
            <option>History & Culture</option>
            <option>Skill Development</option>
            <option>Music & Singing</option>
            <option>Dance & Performance</option>
            <option>Creative Arts</option>
            <option>Food & Cooking Challenges</option>
            <option>Fitness & Sports</option>
            <option>Travel & Exploration</option>
            <option>Photography & Videography</option>
            <option>DIY Projects</option>
            <option>Social Awareness Challenges</option>
          </select>
        </div>
        <div>
          <label for="mLevel" id="lblLevel">Level</label>
          <select id="mLevel" class="input" required>
            <option>Low</option>
            <option>Medium</option>
            <option>Hard</option>
          </select>
        </div>
        <div>
          <label for="mDeadline" id="lblDeadline">Deadline</label>
          <input id="mDeadline" type="date" class="input" required />
        </div>
        <div style="grid-column:1/-1">
          <label for="mDesc" id="lblDesc">Description (current language)</label>
          <textarea id="mDesc" rows="4" class="input" placeholder="Describe the challenge..." required></textarea>
        </div>
      </div>
      <div class="divider"></div>
      <div style="display:flex;gap:8px;justify-content:flex-end">
        <button type="button" class="btn" id="cancelPost">Cancel</button>
        <button type="submit" class="btn primary" id="savePost">Publish</button>
      </div>
    </form>
  </div>
</div>

<div id="toasts" class="toast" aria-live="polite"></div>

<script>
  // UI labels (make sure all translations are complete)
  const uiText = {
    en: {
      search: 'Search', selectInterests: 'Select Interests', category: 'Category', level: 'Level', deadline: 'Deadline', leaderboard: 'Leaderboard',
      postTitle: 'Post a Challenge', title: 'Title', desc: 'Description', publish: 'Publish', cancel: 'Cancel', posted: 'Challenge published'
    },
    bn: {
      search: '‡¶∏‡¶æ‡¶∞‡ßç‡¶ö', selectInterests: '‡¶á‡¶®‡ßç‡¶ü‡¶æ‡¶∞‡ßá‡¶∏‡ßç‡¶ü ‡¶∏‡¶ø‡¶≤‡ßá‡¶ï‡ßç‡¶ü', category: '‡¶ï‡ßç‡¶Ø‡¶æ‡¶ü‡¶æ‡¶ó‡¶∞‡¶ø', level: '‡¶≤‡ßá‡¶≠‡ßá‡¶≤', deadline: '‡¶°‡ßá‡¶°‡¶≤‡¶æ‡¶á‡¶®', leaderboard: '‡¶≤‡¶ø‡¶°‡¶æ‡¶∞‡¶¨‡ßã‡¶∞‡ßç‡¶°',
      postTitle: '‡¶ö‡ßç‡¶Ø‡¶æ‡¶≤‡ßá‡¶û‡ßç‡¶ú ‡¶™‡ßã‡¶∏‡ßç‡¶ü ‡¶ï‡¶∞‡ßÅ‡¶®', title: '‡¶∂‡¶ø‡¶∞‡ßã‡¶®‡¶æ‡¶Æ', desc: '‡¶¨‡¶ø‡¶¨‡¶∞‡¶£', publish: '‡¶™‡¶æ‡¶¨‡¶≤‡¶ø‡¶∂', cancel: '‡¶¨‡¶æ‡¶§‡¶ø‡¶≤', posted: '‡¶ö‡ßç‡¶Ø‡¶æ‡¶≤‡ßá‡¶û‡ßç‡¶ú ‡¶™‡¶æ‡¶¨‡¶≤‡¶ø‡¶∂ ‡¶π‡ßü‡ßá‡¶õ‡ßá'
    },
    hi: {
      search: '‡§ñ‡•ã‡§ú‡•á‡§Ç', selectInterests: '‡§á‡§Ç‡§ü‡§∞‡•á‡§∏‡•ç‡§ü ‡§ö‡•Å‡§®‡•á‡§Ç', category: '‡§∂‡•ç‡§∞‡•á‡§£‡•Ä', level: '‡§∏‡•ç‡§§‡§∞', deadline: '‡§°‡•á‡§°‡§≤‡§æ‡§á‡§®', leaderboard: '‡§≤‡•Ä‡§°‡§∞‡§¨‡•ã‡§∞‡•ç‡§°',
      postTitle: '‡§ö‡•à‡§≤‡•á‡§Ç‡§ú ‡§™‡•ã‡§∏‡•ç‡§ü ‡§ï‡§∞‡•á‡§Ç', title: '‡§∂‡•Ä‡§∞‡•ç‡§∑‡§ï', desc: '‡§µ‡§ø‡§µ‡§∞‡§£', publish: '‡§™‡•ç‡§∞‡§ï‡§æ‡§∂‡§ø‡§§', cancel: '‡§∞‡§¶‡•ç‡§¶', posted: '‡§ö‡•à‡§≤‡•á‡§Ç‡§ú ‡§™‡•ç‡§∞‡§ï‡§æ‡§∂‡§ø‡§§ ‡§π‡•Å‡§Ü'
    }
  };

  // Example posts with translations (ensure all translations are complete)
  const challenges = [
    {
      category: 'Science & Technology', level: 'Low', deadline: '2025-09-12', votes: 7,
      translations: {
        en: { title: '30-sec Science Fact', description: 'Share a quick science fact.' },
        bn: { title: '‡ß©‡ß¶ ‡¶∏‡ßá‡¶ï‡ßá‡¶®‡ßç‡¶°‡ßá‡¶∞ ‡¶¨‡¶ø‡¶ú‡ßç‡¶û‡¶æ‡¶® ‡¶§‡¶•‡ßç‡¶Ø', description: '‡¶¶‡ßç‡¶∞‡ßÅ‡¶§ ‡¶è‡¶ï‡¶ü‡¶ø ‡¶¨‡¶ø‡¶ú‡ßç‡¶û‡¶æ‡¶® ‡¶§‡¶•‡ßç‡¶Ø ‡¶∂‡ßá‡¶Ø‡¶º‡¶æ‡¶∞ ‡¶ï‡¶∞‡ßÅ‡¶®‡•§' },
        hi: { title: '30 ‡§∏‡•á‡§ï‡§Ç‡§° ‡§µ‡§ø‡§ú‡•ç‡§û‡§æ‡§® ‡§§‡§•‡•ç‡§Ø', description: '‡§è‡§ï ‡§§‡•ç‡§µ‡§∞‡§ø‡§§ ‡§µ‡§ø‡§ú‡•ç‡§û‡§æ‡§® ‡§§‡§•‡•ç‡§Ø ‡§∏‡§æ‡§ù‡§æ ‡§ï‡§∞‡•á‡§Ç‡•§' }
      }
    },
    {
      category: 'Fun Challenges', level: 'Medium', deadline: '2025-09-15', votes: 12,
      translations: {
        en: { title: 'Kitchen Rhythm Beat', description: 'Create a beat using kitchen items.' },
        bn: { title: '‡¶ï‡¶ø‡¶ö‡ßá‡¶® ‡¶∞‡¶ø‡¶¶‡¶Æ ‡¶¨‡¶ø‡¶ü', description: '‡¶∞‡¶æ‡¶®‡ßç‡¶®‡¶æ‡¶ò‡¶∞‡ßá‡¶∞ ‡¶ú‡¶ø‡¶®‡¶ø‡¶∏ ‡¶¶‡¶ø‡¶Ø‡¶º‡ßá ‡¶¨‡¶ø‡¶ü ‡¶§‡ßà‡¶∞‡¶ø ‡¶ï‡¶∞‡ßÅ‡¶®‡•§' },
        hi: { title: '‡§ï‡§ø‡§ö‡§® ‡§∞‡§ø‡§¶‡§Æ ‡§¨‡•Ä‡§ü', description: '‡§∞‡§∏‡•ã‡§à ‡§ï‡•á ‡§∏‡§æ‡§Æ‡§æ‡§® ‡§∏‡•á ‡§¨‡•Ä‡§ü ‡§¨‡§®‡§æ‡§è‡§Ç‡•§' }
      }
    },
    {
      category: 'Coding & Programming', level: 'Hard', deadline: '2025-09-11', votes: 4,
      translations: {
        en: { title: 'Mini Portfolio Landing', description: 'Build a single-page portfolio.' },
        bn: { title: '‡¶Æ‡¶ø‡¶®‡¶ø ‡¶™‡ßã‡¶∞‡ßç‡¶ü‡¶´‡ßã‡¶≤‡¶ø‡¶ì ‡¶≤‡ßç‡¶Ø‡¶æ‡¶®‡ßç‡¶°‡¶ø‡¶Ç', description: '‡¶è‡¶ï‡¶ü‡¶ø ‡¶∏‡¶ø‡¶ô‡ßç‡¶ó‡ßá‡¶≤-‡¶™‡ßá‡¶ú ‡¶™‡ßã‡¶∞‡ßç‡¶ü‡¶´‡ßã‡¶≤‡¶ø‡¶ì ‡¶¨‡¶æ‡¶®‡¶æ‡¶®‡•§' },
        hi: { title: '‡§Æ‡§ø‡§®‡•Ä ‡§™‡•ã‡§∞‡•ç‡§ü‡§´‡•ã‡§≤‡§ø‡§Ø‡•ã ‡§≤‡•à‡§Ç‡§°‡§ø‡§Ç‡§ó', description: '‡§è‡§ï ‡§∏‡§ø‡§Ç‡§ó‡§≤-‡§™‡•á‡§ú ‡§™‡•ã‡§∞‡•ç‡§ü‡§´‡•ã‡§≤‡§ø‡§Ø‡•ã ‡§¨‡§®‡§æ‡§è‡§Ç‡•§' }
      }
    }
  ];

  // Points / leaderboard
  const points = { 'Aisha': 12, 'Ravi': 18, 'You': 5 };

  // State
  let selectedInterest = 'All';
  let searchQuery = '';
  let currentLang = 'en';

  // Cache DOM elements for performance
  const $ = selector => document.querySelector(selector);
  const $searchInput = $('#searchInput');
  const $interestTitle = $('#interestTitle');
  const $leaderboardTitle = $('#leaderboardTitle');
  const $modalTitle = $('#modalTitle');
  const $lblTitle = $('#lblTitle');
  const $lblDesc = $('#lblDesc');
  const $lblCategory = $('#lblCategory');
  const $lblLevel = $('#lblLevel');
  const $lblDeadline = $('#lblDeadline');
  const $savePost = $('#savePost');
  const $cancelPost = $('#cancelPost');
  const $challengeForm = $('#challengeForm');
  const $backdrop = $('#backdrop');
  const $challengeFeed = $('#challengeFeed');
  const $leaderboard = $('#leaderboard');
  const $toasts = $('#toasts');
  const $interestSelect = $('#interestSelect');
  const $languageSelect = $('#languageSelect');
  const $postBtn = $('#postBtn');
  const $closeModal = $('#closeModal');
  const $mTitle = $('#mTitle');
  const $mDesc = $('#mDesc');
  const $mCategory = $('#mCategory');
  const $mLevel = $('#mLevel');
  const $mDeadline = $('#mDeadline');

  function toast(msg) {
    const el = document.createElement('div');
    el.className = 'item';
    el.textContent = msg;
    $toasts.appendChild(el);
    setTimeout(() => {
      el.style.opacity = '0';
      el.style.transform = 'translateY(6px)';
    }, 2400);
    setTimeout(() => {
      $toasts.removeChild(el);
    }, 3000);
  }

  function applyTranslations() {
    const t = uiText[currentLang];
    $searchInput.placeholder = t.search;
    $interestTitle.textContent = t.selectInterests;
    $leaderboardTitle.textContent = t.leaderboard;
    // Modal labels
    $modalTitle.textContent = t.postTitle;
    $lblTitle.textContent = `${t.title} (${currentLang})`;
    $lblDesc.textContent = `${t.desc} (${currentLang})`;
    $lblCategory.textContent = t.category;
    $lblLevel.textContent = t.level;
    $lblDeadline.textContent = t.deadline;
    $savePost.textContent = t.publish;
    $cancelPost.textContent = t.cancel;
  }

  function renderLeaderboard() {
    $leaderboard.innerHTML = '';
    Object.entries(points).sort((a, b) => b[1] - a[1]).forEach(([user, pts], i) => {
      const row = document.createElement('div');
      row.className = 'row';
      row.innerHTML = `<span>#${i + 1} ${user}</span><strong>${pts} pts</strong>`;
      $leaderboard.appendChild(row);
    });
  }

  function renderFeed() {
    const t = uiText[currentLang];
    let list = challenges
      .filter(c => selectedInterest === 'All' || c.category === selectedInterest)
      .filter(c => {
        const tr = c.translations[currentLang] || c.translations.en;
        return !searchQuery || tr.title.toLowerCase().includes(searchQuery) || tr.description.toLowerCase().includes(searchQuery);
      });

    $challengeFeed.innerHTML = '';
    if (list.length === 0) {
      $challengeFeed.innerHTML = `<div class="card">${t.search}: No challenges found.</div>`;
      return;
    }
    list.forEach(c => {
      const tr = c.translations[currentLang] || c.translations.en;
      const card = document.createElement('div');
      card.className = 'card';
      card.innerHTML = `
        <h3>${tr.title}</h3>
        <div class="meta">
          <span><strong>${t.category}:</strong> ${c.category}</span>
          <span><strong>${t.level}:</strong> ${c.level}</span>
          <span><strong>${t.deadline}:</strong> ${c.deadline}</span>
        </div>
        <p class="desc">${tr.description}</p>
      `;
      $challengeFeed.appendChild(card);
    });
  }

  // Modal open/close
  $postBtn.addEventListener('click', () => {
    $backdrop.style.display = 'flex';
    $mTitle.focus();
  });
  $closeModal.addEventListener('click', () => {
    $backdrop.style.display = 'none';
  });
  $cancelPost.addEventListener('click', () => {
    $backdrop.style.display = 'none';
  });
  // Allow closing modal with Escape key
  window.addEventListener('keydown', e => {
    if (e.key === 'Escape' && $backdrop.style.display === 'flex') {
      $backdrop.style.display = 'none';
    }
  });

  // Save post (form submit)
  $challengeForm.addEventListener('submit', e => {
    e.preventDefault();
    const title = $mTitle.value.trim();
    const description = $mDesc.value.trim();
    const category = $mCategory.value;
    const level = $mLevel.value;
    const deadline = $mDeadline.value;

    if (!title || !description || !deadline) {
      toast('Please fill Title, Description and Deadline');
      return;
    }

    // Create a new challenge with content for the current language
    const newChallenge = {
      category, level, deadline, votes: 0,
      translations: {
        [currentLang]: { title, description }
      }
    };
    // Ensure English fallback if posted in another language
    if (currentLang !== 'en') {
      newChallenge.translations.en = { title, description };
    }

    challenges.unshift(newChallenge); // add to top
    points['You'] = (points['You'] || 0) + 5; // posting gives +5

    // reset + close
    $challengeForm.reset();
    $backdrop.style.display = 'none';
    toast(uiText[currentLang].posted || 'Posted');
    renderFeed();
    renderLeaderboard();
  });

  // Controls
  $interestSelect.addEventListener('change', e => {
    selectedInterest = e.target.value;
    renderFeed();
  });
  $searchInput.addEventListener('input', e => {
    searchQuery = e.target.value.toLowerCase();
    renderFeed();
  });
  $languageSelect.addEventListener('change', e => {
    currentLang = e.target.value;
    applyTranslations();
    renderFeed();
  });

  // Init
  applyTranslations();
  renderLeaderboard();
  renderFeed();

</script>
</body>
</html>
